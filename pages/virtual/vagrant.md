<div style="background:#000;border:1px solid green;color:#00FF00;border-radius:5px;overflow:auto">
  <div style="vertical-align:middle;text-align:center;margin:25px auto">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 222.53 60.01" class="logo" height="120">
  <path class="text" fill="#FFF" d="M82.58 7.86V4.63h-3v3.23h-1.46V.11h1.51v3.25h3V.11h1.51v7.75zm7 0h-1.2l-.11-.38a3.28 3.28 0 0 1-1.7.52c-1.06 0-1.52-.7-1.52-1.66 0-1.14.51-1.57 1.7-1.57h1.4v-.62c0-.62-.18-.84-1.11-.84a8.46 8.46 0 0 0-1.61.17l-.18-1.07a7.89 7.89 0 0 1 2-.26c1.83 0 2.37.62 2.37 2zm-1.43-2.11h-1.08c-.48 0-.61.13-.61.55s.13.56.59.56a2.37 2.37 0 0 0 1.1-.29zM92.66 8a7.12 7.12 0 0 1-2-.32l.2-1.07a6.77 6.77 0 0 0 1.73.24c.65 0 .74-.14.74-.56s-.07-.52-1-.73c-1.42-.33-1.59-.68-1.59-1.76s.51-1.62 2.18-1.62a8 8 0 0 1 1.75.2l-.17 1.08a10.66 10.66 0 0 0-1.6-.16c-.63 0-.74.14-.74.48s0 .48.82.68c1.63.41 1.78.62 1.78 1.77S94.42 8 92.66 8zm6.68-.11V4c0-.3-.13-.45-.47-.45a4.14 4.14 0 0 0-1.52.45v3.86H95.9V0l1.46.22v2.47a5.31 5.31 0 0 1 2.13-.54c1 0 1.32.65 1.32 1.65v4.06zM102 1.48V.11h1.46v1.37zm0 6.38V2.27h1.46v5.59zm2.62-5.54c0-1.4.85-2.22 2.83-2.22a9.37 9.37 0 0 1 2.16.25l-.17 1.25a12.21 12.21 0 0 0-1.95-.2c-1 0-1.37.34-1.37 1.16V5.5c0 .81.33 1.16 1.37 1.16a12.21 12.21 0 0 0 1.95-.2l.17 1.25a9.37 9.37 0 0 1-2.16.25c-2 0-2.83-.81-2.83-2.22zM112.86 8c-2 0-2.53-1.06-2.53-2.2V4.36c0-1.15.54-2.2 2.53-2.2s2.53 1.06 2.53 2.2v1.41c.01 1.15-.53 2.23-2.53 2.23zm0-4.63c-.78 0-1.08.33-1.08 1v1.5c0 .63.3 1 1.08 1s1.08-.33 1.08-1V4.31c0-.63-.3-.96-1.08-.96zm6.64.09a11.57 11.57 0 0 0-1.54.81v3.6h-1.46v-5.6h1.23l.1.62a6.63 6.63 0 0 1 1.53-.73zM125.34 6a1.73 1.73 0 0 1-1.92 2 8.36 8.36 0 0 1-1.55-.16v2.26l-1.46.22v-8h1.16l.14.47a3.15 3.15 0 0 1 1.84-.59c1.17 0 1.79.67 1.79 1.94zm-3.48.63a6.72 6.72 0 0 0 1.29.15c.53 0 .73-.24.73-.75v-2c0-.46-.18-.71-.72-.71a2.11 2.11 0 0 0-1.3.51zM99.88 14.1h6.29l-9.56 32h-8.93l-9.56-32h6.29l7.73 26.66zm23.78 32h-4.8l-.43-1.59a12.8 12.8 0 0 1-7 2.07c-4.28 0-6.1-2.93-6.1-7 0-4.76 2.07-6.58 6.82-6.58h5.62v-2.42c0-2.59-.72-3.51-4.47-3.51a32.69 32.69 0 0 0-6.49.72l-.72-4.47a30.53 30.53 0 0 1 8-1.11c7.35 0 9.51 2.59 9.51 8.46zm-5.86-8.84h-4.32c-1.92 0-2.45.53-2.45 2.31s.53 2.35 2.35 2.35a9.23 9.23 0 0 0 4.42-1.2zm17.05 2.54a2.52 2.52 0 0 0-1.39 1.87c0 .62.38.91 1.3 1 2.59.29 4 .43 6.77.72 3.8.43 5 2.31 5 5.67 0 5-1.83 7-10.57 7a34.06 34.06 0 0 1-9-1.2l.72-4.37a32.49 32.49 0 0 0 7.88 1c4.66 0 5.57-.34 5.57-1.87s-.43-1.68-2.21-1.87c-2.69-.29-3.8-.43-6.77-.77-3.31-.38-4.61-1.49-4.61-4.47a5 5 0 0 1 2.45-4c-2.16-1.3-3.17-3.46-3.17-6.29V30c.1-4.85 2.64-7.78 9.42-7.78a15.9 15.9 0 0 1 4 .48h7.21v2.93c-.82.24-1.78.48-2.59.72a8 8 0 0 1 .82 3.65v2.21c0 4.76-2.88 7.64-9.42 7.64a12.18 12.18 0 0 1-1.41-.05zm1.34-12.88c-2.88 0-3.89 1.06-3.89 3.27V32c0 2.31 1.15 3.17 3.89 3.17s3.94-.91 3.94-3.17v-1.81c.01-2.19-1-3.26-3.93-3.26zm25.9.68a45.87 45.87 0 0 0-6.19 3.4v15.1H150V22.7h5l.38 2.59a26.22 26.22 0 0 1 6.15-3.07zm19.6 18.5h-4.8l-.43-1.59a12.8 12.8 0 0 1-7 2.07c-4.28 0-6.1-2.93-6.1-7 0-4.76 2.07-6.58 6.82-6.58h5.62v-2.42c0-2.59-.72-3.51-4.47-3.51a32.69 32.69 0 0 0-6.49.72l-.72-4.47a30.53 30.53 0 0 1 8-1.11c7.35 0 9.51 2.59 9.51 8.46zm-5.86-8.84h-4.32c-1.92 0-2.45.53-2.45 2.31s.53 2.35 2.35 2.35a9.23 9.23 0 0 0 4.42-1.2zm23.3 8.84V29.76c0-1.25-.53-1.87-1.87-1.87a16.16 16.16 0 0 0-6.1 2V46.1h-5.86V22.7h4.47l.58 2a23.43 23.43 0 0 1 9.37-2.45c3.89 0 5.28 2.74 5.28 6.92v17zm23.11-.44a16.25 16.25 0 0 1-5.14.91c-4.28 0-6.44-2-6.44-6.2v-13h-3.51V22.7h3.51v-5.81l5.86-.82v6.63h6l-.38 4.66h-5.62v12.25a1.85 1.85 0 0 0 2.11 2.07 11.27 11.27 0 0 0 2.93-.48z"></path>
  <path class="front" fill="#1563FF" d="M58.03 10.12V4.63L44.84 12.3v4.64L34.29 39.7l-5.28 3.64v16.67l11.31-6.52 17.71-43.37zM29.01 31.47L21.1 13V7.78l-.05-.02-7.86 4.54v4.64L23.74 40.7l5.27-2.61v-6.62z"></path>
  <path class="shadow" fill="#104EB2" d="M50.12.01L36.94 7.73h-.01V13l-7.92 18.47v6.17l-5.27 3.06-10.55-23.76v-4.65l7.92-4.55L7.91.01 0 4.63v5.66l17.81 43.25 11.2 6.47V43.76l5.28-3.06-.07-.04 10.62-23.72v-4.65l13.19-7.66L50.12.01z"></path>
</svg>
    <hr style="color: #FFF;width:65%;margin:5px auto"/>
    <div style="text-align:left;width:60%;margin: 10px auto">
      Vagrant 是一款用来构建虚拟开发环境的工具,非常适合"php/python/ruby/java" 这类语言开发web应用,"代码在我机子上运行没有问题"这种说辞将成为历史。
      我们可以通过 Vagrant 封装一个Linux 的开发环境，分发给团队成员。
    </div>
  </div>
</div>



---

## 安装步骤

### 1.安装virtualBox

虚拟机还是得依靠VirtualBox来搭建

下载地址: [VirtualBox下载](https://www.virtualbox.org/wiki/Downloads)

Tips: `虽然Vagrant也支持VMWare，不过VMWare是收费的，对应的Vagrant版本也是收费的`

### 2.安装Vagrant并添加镜像

下载地址: [Vagrant下载](https://www.vagrantup.com/downloads.html)

装好以后运行`Vagrant box add hashicorp/precise64`添加Vagrant官方的box镜像。这是将从官网下载名为`hashicorp/precise64`的box，可能需要等待一段时间。

如果需要其他系统的镜像，可以来这里查询下载: [https://atlas.hashicorp.com/boxes/search](https://atlas.hashicorp.com/boxes/search)

Tips: 如果因为网络原因添加不了上面的镜像，可以用工具将这些box下载下来（[下载地址](https://github.com/chef/bento)），参照后文的“打包分发”部分进行添加。

### 3.初始化开发环境

创建一个开发目录（比如：~/dev），你也可以使用已有的目录，切换到开发目录里，用`hashicorp/precise64`镜像初始化当前目录的环境:
```
$ cd ~/dev  # 切换目录
$ vagrant init hashicorp/precise64  # 用 hashicorp/precise64 进行 box 初始化
$ vagrant up  # 启动环境
```

你会看到终端显示了启动过程，启动完成后，我们就可以使用SSH登录虚拟机了，剩下的步骤就是在虚拟机里配置你要运行的各种环境和参数了。
```
$ vagrant ssh  # SSH 登录
$ cd /vagrant  # 切换到开发目录，也就是宿主机上的 `~/dev`
```

`~/dev`目录对应虚拟机中的目录 `/vagrant`

**Windows用户注意**: windows终端并不支持ssh，所以需要安装第三方SSH客户端，比如: putty、cygwin等。

## 其他设置
Vagrant初始化成功后，会在初始化的目录里生产一个Vagrantfile的配置文件，可以修改文件进行个性化的定制。

Vagrant默认是使用端口映射方式静虚拟机的端口映射本地从而实现类似`http://localhost:80/`这样访问方式，这种方式比较麻烦，新开和修改端口的时候都得编辑。相比较而言，host-only模式显的方便多了。打开`Vagrantfile`，将下面这行的注释去掉（移除#）并保存:
```
config.vm.network: private_network, ip: "192.168.33.10"
```

## 打包分发
当你配置好开发环境后，退出并关闭虚拟机。在终端里对开发环境进行打包：
```
$ vagrant package
```

打包完成后会在当前目录生成一个 `package.box` 的文件，将这个文件传给其他用户，其他用户只要添加这个 box 并用其初始化自己的开发目录就能得到一个一模一样的开发环境了。

添加方法：

假设我们拿到的 box 存放路径是 ~/box/package.box，在终端里输入：
```
$ vagrant box add hahaha ~/box/package.box  # 添加 package.box 镜像并命名为 hahaha
$ cd ~/dev  # 切换到项目目录
$ vagrant init hahaha  # 用 hahaha 镜像初始化。
```

## 集成预安装

从上面这条看下来，你会发现每次都修改了一点点内容，再打包分发给其他用户其实很麻烦。为此 Vagrant 还提供了更为便捷的预安装定制。打开 Vagrantfile 文件末尾处有下面被注释的代码：
```
config.vm.provision "shell", inline: <<-SHELL
   apt-get update
   apt-get install -y apache2
SHELL
```

没错，这段代码就是让你在初次运行 `vagrant up` 后，虚拟机创建过程众自动运行的初始化命令。 取消注释，把要预先安装的 php/mysql/redis 和配置之类的通通都写进去。初始化时这些程序都会根据你写好的方法安装并配置。

如果你不是初次运行，同时又修改了这里的命令，想让系统再次运行这里面的命令，你可以使用 `vagrant reload --provision` 进行重载。所以在这种情况下，你只要将 `Vagrantfile` 共享给团队的其他成员就可以了，其他成员运行相同的命令即可，是不是比打包分发要方便许多。

你还可以把要运行的命令单独写在一个文件里存放在相同的目录下，比如 bootstrap.sh：
```
#!/usr/bin/env bash

apt-get update
apt-get install -y apache2
if ! [ -L /var/www ]; then
  rm -rf /var/www
  ln -fs /vagrant /var/www
fi
```
然后在 Vagrantfile 里这样添加：
```
Vagrant.configure("2") do |config|
  config.vm.box = "hashicorp/precise64"
  ...

  config.vm.provision "shell", path: "bootstrap.sh"  # 添加这行
end
```

效果和直接写在 Vagrantfile 是一样的。

## 常用命令

```
$ vagrant init  # 初始化
$ vagrant up  # 启动虚拟机
$ vagrant halt  # 关闭虚拟机
$ vagrant reload  # 重启虚拟机
$ vagrant ssh  # SSH 至虚拟机
$ vagrant status  # 查看虚拟机运行状态
$ vagrant destroy  # 销毁当前虚拟机
```

更多内容请查阅官方文档 [https://www.vagrantup.com/doc...](https://www.vagrantup.com/docs/cli/index.html)

## 注意事项

使用Apache、NGINX时会出现诸如图片修改后但刷新仍然是旧文件的情况，是由于VirtualBox的一个BUG造成的。需要对虚拟机的Apache/Nginx配置文件进行修改:
```
# Apache 配置（http.conf或者apache.conf）修改:
EnableSendfile off

# Nginx 配置（nginx.conf）修改:
sendfile off;
```

---

